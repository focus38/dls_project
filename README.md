# Итоговый проект в рамках курса Deep Learning (семестр 1, весна 2025)

## Проблема и описание предполагаемого решения

### Детекция области показаний электрического счетчика
На текущем этапе планируется реализовать определение области, содержащей показания счетчика. В дальнейшем (на следующем этапе) планируется выделение числовых значений этих показаний.<br>

### Решение
Для детекции будет использоваться предварительно обученная модель. Для удобства тестирования и демонстрации планируется разработать простой веб-интерфейс.<br>

### Работа системы
- Пользователь загружает фотографию электросчетчика через веб-интерфейс.
- Изображение передается на вход модели.
- Модель обрабатывает данные и определяет область с показаниями.
- На исходном изображении выделяется предсказанная область.
- Результат отображается пользователю в веб-интерфейсе.

## Поиск обученной модели и датасета
В процессе поиска обученной модели пересмотрел несколько вариантов, которые были доступны на сайте https://universe.roboflow.com/<br>
Почему именно этот сайт. Этот ресурс содержит датасеты к разным предметным областям. Именно тут я нашел датасеты для моей предметной области.<br>
На этом сайте поиск датасетов с моделями по запросу "electric-meter" вернул порядка 300 записей. Из этих записей выбрал те, где было большое количество файлов.<br>
На своей тестовой выборке (69 изображений) провел тестирование 18-ти сторонних моделей.

| Модель                           | Ссылка на модель                                                                                                                                                                                                         | Количество изображений в тестовой выборке | Количество изображений с детекцией | % с детекцией | Количество электронных с детекцией | Количество старых аналоговых с детекцией | Количество современных аналоговых с детекцией | Среднее значение confidence | Минимальное время обработки (сек) | Среднее время обработки (сек) | Максимальное время обработки (сек) | Выполнена детекция, где изображение повернуто на 90 гр. | Выполнена детекция, где изображение повернуто на 180 гр. | Выполнена детекция, где изображение повернуто на 270 гр. |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ----------------------------------------- |------------------------------------|--------------|------------------------------------|------------------------------------------|-----------------------------------------------|-----------------------------|-----------------------------------|-------------------------------|------------------------------------| ------------------------------------------------------ | -------------------------------------------------------- |----------------------------------------------------------|
| utility-meter-display/1          | [https://universe.roboflow.com/ali-zafar-vbaxz/utility-meter-display/model/1](https://universe.roboflow.com/ali-zafar-vbaxz/utility-meter-display/model/1)                                                               | 69                                        | 56                                 | 0,81         | 20                                 | 17                                       | 19                                            | 0,8088                      | 0,16                              | 0,22                          | 0,99                               | 0                                                      | 1                                                        | 0                                                        |
| vkr-mtaxg/2                      | [https://universe.roboflow.com/lr4-i2pis/vkr-mtaxg/model/2](https://universe.roboflow.com/lr4-i2pis/vkr-mtaxg/model/2)                                                                                                   | 69                                        | 56                                 | 0,81         | 11                                 | 22                                       | 23                                            | 0,7793                      | 0,17                              | 0,2                           | 0,38                               | 0,6666666667                                           | 0,6666666667                                             | 0,6666666667                                             |
| asdzxc/1                         | [https://universe.roboflow.com/traicocem9-gmail-com/asdzxc/model/1](https://universe.roboflow.com/traicocem9-gmail-com/asdzxc/model/1)                                                                                   | 69                                        | 51                                 | 0,74         | 12                                 | 17                                       | 22                                            | 0,7382                      | 0,05                              | 0,07                          | 0,15                               | 0,3333333333                                           | 0,6666666667                                             | 0                                                        |
| electric-meter-fraud-detection/2 | [https://universe.roboflow.com/electric-meter-fraud-detection-system/electric-meter-fraud-detection/model/2](https://universe.roboflow.com/electric-meter-fraud-detection-system/electric-meter-fraud-detection/model/2) | 69                                        | 49                                 | 0,71         | 19                                 | 18                                       | 12                                            | 0,6519                      | 0,18                              | 0,23                          | 0,38                               | 0,3333333333                                           | 0,6666666667                                             | 0                                                        |
| counter-value/2                  | [https://universe.roboflow.com/counter-6mnx7/counter-value/model/2](https://universe.roboflow.com/counter-6mnx7/counter-value/model/2)                                                                                   | 69                                        | 49                                 | 0,71         | 12                                 | 14                                       | 23                                            | 0,7843                      | 0,16                              | 0,23                          | 1,02                               | 0,3333333333                                           | 1                                                        | 0,3333333333                                             |
| brojilo/1                        | [https://universe.roboflow.com/petar-rukan/brojilo/model/1](https://universe.roboflow.com/petar-rukan/brojilo/model/1)                                                                                                   | 69                                        | 43                                 | 0,62         | 7                                  | 18                                       | 18                                            | 0,7776                      | 0,18                              | 0,21                          | 0,37                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| meteran-listrik/1                | [https://universe.roboflow.com/caesario-dito-iysmw/meteran-listrik/model/1](https://universe.roboflow.com/caesario-dito-iysmw/meteran-listrik/model/1)                                                                   | 69                                        | 38                                 | 0,55         | 3                                  | 16                                       | 19                                            | 0,738                       | 0,53                              | 0,6                           | 0,91                               | 0                                                      | 0,6666666667                                             | 0                                                        |
| automatic-meter-reading/6        | [https://universe.roboflow.com/automatic-meter-reading/automatic-meter-reading/model/6](https://universe.roboflow.com/automatic-meter-reading/automatic-meter-reading/model/6)                                           | 69                                        | 34                                 | 0,49         | 7                                  | 11                                       | 16                                            | 0,6705                      | 0,48                              | 0,59                          | 1,01                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| meter-detection-xz9jh/1          | [https://universe.roboflow.com/object-detection-0j4p6/meter-detection-xz9jh/model/1](https://universe.roboflow.com/object-detection-0j4p6/meter-detection-xz9jh/model/1)                                                 | 69                                        | 30                                 | 0,43         | 18                                 | 6                                        | 6                                             | 0,7552                      | 0,07                              | 0,09                          | 0,17                               | 0                                                      | 0                                                        | 0                                                        |
| register-2/3                     | [https://universe.roboflow.com/register-whrdt/register-2/model/3](https://universe.roboflow.com/register-whrdt/register-2/model/3)                                                                                       | 69                                        | 28                                 | 0,41         | 0                                  | 11                                       | 17                                            | 0,8117                      | 0,17                              | 0,2                           | 0,35                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| powermeter/1                     | [https://universe.roboflow.com/test-4udyq/powermeter/model/1](https://universe.roboflow.com/test-4udyq/powermeter/model/1)                                                                                               | 69                                        | 28                                 | 0,41         | 1                                  | 16                                       | 11                                            | 0,7359                      | 0,09                              | 0,12                          | 0,24                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| medidores-de-energia/2           | [https://universe.roboflow.com/medidores-v0fpg/medidores-de-energia/model/2](https://universe.roboflow.com/medidores-v0fpg/medidores-de-energia/model/2)                                                                 | 69                                        | 27                                 | 0,39         | 11                                 | 3                                        | 13                                            | 0,6895                      | 0,14                              | 0,24                          | 0,75                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| register-en5sj/1                 | [https://universe.roboflow.com/putra-l8mtw/register-en5sj/model/1](https://universe.roboflow.com/putra-l8mtw/register-en5sj/model/1)                                                                                     | 69                                        | 22                                 | 0,32         | 1                                  | 12                                       | 9                                             | 0,7042                      | 0,17                              | 0,21                          | 0,86                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| meter_detection-ue2if/1          | [https://universe.roboflow.com/fast-nuces-b1tsl/meter_detection-ue2if/model/1](https://universe.roboflow.com/fast-nuces-b1tsl/meter_detection-ue2if/model/1)                                                             | 69                                        | 22                                 | 0,32         | 0                                  | 12                                       | 10                                            | 0,7811                      | 0,07                              | 0,08                          | 0,14                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| electric-meter2000/1             | [https://universe.roboflow.com/test-voktw/electric-meter2000/model/1](https://universe.roboflow.com/test-voktw/electric-meter2000/model/1)                                                                               | 69                                        | 21                                 | 0,3          | 1                                  | 8                                        | 12                                            | 0,7121                      | 0,07                              | 0,1                           | 0,23                               | 0,3333333333                                           | 0                                                        | 0                                                        |
| register-digital/2               | [https://universe.roboflow.com/register-whrdt/register-digital/model/2](https://universe.roboflow.com/register-whrdt/register-digital/model/2)                                                                           | 69                                        | 17                                 | 0,25         | 14                                 | 1                                        | 2                                             | 0,7189                      | 0,18                              | 0,22                          | 0,41                               | 0                                                      | 0,3333333333                                             | 0                                                        |
| cts-oosrg/1                      | [https://universe.roboflow.com/cts-tny9b/cts-oosrg/model/1](https://universe.roboflow.com/cts-tny9b/cts-oosrg/model/1)                                                                                                   | 69                                        | 8                                  | 0,12         | 2                                  | 2                                        | 4                                             | 0,7189                      | 0,19                              | 0,26                          | 0,69                               | 0                                                      | 0                                                        | 0                                                        |
| geral_pointer/4                  | [https://universe.roboflow.com/meddetection/geral_pointer/model/4](https://universe.roboflow.com/meddetection/geral_pointer/model/4)                                                                                     | 69                                        | 2                                  | 0,03         | 0                                  | 2                                        | 0                                             | 0,5287                      | 0,19                              | 0,24                          | 0,37                               | 0                                                      | 0                                                        | 0                                                        |

Наилучшие результаты для сторонних моделей показали: utility-meter-display/1 и vkr-mtaxg/2.<br>
<b>Почти все модели закрыты коммерческой лицензией</b><br>
<b>К сожалению у roboflow базовый тарифный план не позволяет скачать натренированную модель (веса) в виде файла, чтобы потом использовать в своем проекте.</b><br>
<b>Но можно скачать размеченный датасет, например для YOLO11, и попробовать обучить самостоятельно модель.</b><br>

## Обучение модели
В качестве модели, которую буду обучать, я выбрал YOLO11. После анализа датасетов выбор пал на датасет vkr-mtaxg/2.
Натренированная модель на тестовой выборке оказала следующие результаты:

| Модель                           | Ссылка на модель                                                                                                                                                                                                         | Количество изображений в тестовой выборке | Количество изображений с детекцией | % с детекцией | Количество электронных с детекцией | Количество старых аналоговых с детекцией | Количество современных аналоговых с детекцией | Среднее значение confidence | Минимальное время обработки (сек) | Среднее время обработки (сек) | Максимальное время обработки (сек) | Выполнена детекция, где изображение повернуто на 90 гр. | Выполнена детекция, где изображение повернуто на 180 гр. | Выполнена детекция, где изображение повернуто на 270 гр. |
|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ----------------------------------------- |------------------------------------|--------------|------------------------------------|------------------------------------------|-----------------------------------------------|-----------------------------|-----------------------------------|-------------------------------|------------------------------------| ------------------------------------------------------ | -------------------------------------------------------- |----------------------------------------------------------|
| emeter-yolo11n/1                 | Натренированная модель. Нет в публичном доступе.                                                                                                 | 69                                        | 62                                 | 0,9          | 17                                 | 22                                       | 23                                            | 0,8579                      | 0,15                              | 0,21                          | 0,34                               | 0,6666666667                                           | 1                                                        | 1                                                        |

Натренированная модель показывает лучший результат по сравнению с 18-тю сторонними моделями.<br>
Ее и будем использовать далее в проекте.<br>
[Детали обучения модели](train/emeter-yolo11n.md)